---
// Scroll-triggered animations using Intersection Observer
---

<script>
  // Wait for DOM to be ready
  document.addEventListener('DOMContentLoaded', () => {
    // Elements with scroll animations
    const animatedElements = document.querySelectorAll('[data-animate]');

    const observerOptions = {
      root: null,
      rootMargin: '50px 0px -50px 0px',
      threshold: 0.1,
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const el = entry.target;
          const animation = el.dataset.animate;
          const delay = el.dataset.delay || '0';

          setTimeout(() => {
            el.classList.add('is-visible');
            el.classList.add(`animate-${animation}`);
          }, parseInt(delay));

          observer.unobserve(el);
        }
      });
    }, observerOptions);

    animatedElements.forEach((el) => {
      observer.observe(el);
    });

    // Parallax scroll effect for hero
    const hero = document.querySelector('.hero-content');
    if (hero) {
      window.addEventListener('scroll', () => {
        const scrolled = window.scrollY;
        const rate = scrolled * 0.3;
        hero.style.transform = `translateY(${rate}px)`;
        hero.style.opacity = String(Math.max(0, 1 - scrolled / 600));
      });
    }
  });
</script>

<style is:global>
  /* Base state for animated elements */
  [data-animate] {
    opacity: 0;
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  [data-animate].is-visible {
    opacity: 1;
  }

  /* Fade up animation */
  [data-animate="fade-up"] {
    transform: translateY(40px);
  }

  [data-animate="fade-up"].is-visible {
    transform: translateY(0);
  }

  /* Fade in animation */
  [data-animate="fade-in"] {
    transform: scale(0.95);
  }

  [data-animate="fade-in"].is-visible {
    transform: scale(1);
  }

  /* Slide in from left */
  [data-animate="slide-left"] {
    transform: translateX(-60px);
  }

  [data-animate="slide-left"].is-visible {
    transform: translateX(0);
  }

  /* Slide in from right */
  [data-animate="slide-right"] {
    transform: translateX(60px);
  }

  [data-animate="slide-right"].is-visible {
    transform: translateX(0);
  }

  /* Scale up */
  [data-animate="scale-up"] {
    transform: scale(0.8);
  }

  [data-animate="scale-up"].is-visible {
    transform: scale(1);
  }

  /* Stagger children */
  [data-animate-stagger] > * {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
  }

  [data-animate-stagger].is-visible > *:nth-child(1) { transition-delay: 0ms; opacity: 1; transform: translateY(0); }
  [data-animate-stagger].is-visible > *:nth-child(2) { transition-delay: 100ms; opacity: 1; transform: translateY(0); }
  [data-animate-stagger].is-visible > *:nth-child(3) { transition-delay: 200ms; opacity: 1; transform: translateY(0); }
  [data-animate-stagger].is-visible > *:nth-child(4) { transition-delay: 300ms; opacity: 1; transform: translateY(0); }
  [data-animate-stagger].is-visible > *:nth-child(5) { transition-delay: 400ms; opacity: 1; transform: translateY(0); }
  [data-animate-stagger].is-visible > *:nth-child(6) { transition-delay: 500ms; opacity: 1; transform: translateY(0); }

  /* Number counter animation */
  .count-up {
    transition: all 0.3s ease-out;
  }

  /* Progress line animation */
  .progress-line {
    transform-origin: left;
    transform: scaleX(0);
    transition: transform 1s ease-out;
  }

  .progress-line.is-visible {
    transform: scaleX(1);
  }
</style>
